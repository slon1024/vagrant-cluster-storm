description "Kafka"

start on runlevel [2345]
stop on starting rc RUNLEVEL=[016]

respawn
respawn limit 10 30

env HOME={{ kafka['home_dir'] }}/config
env KAFKA_HOME={{ kafka['home_dir'] }}
umask 007

kill timeout 300

pre-start script
#Sanity checks
[ -r $HOME/server.properties ]
end script

setuid kafka
setgid kafka

export JMX_PORT=${JMX_PORT:-{{ kafka['jmx_port'] }}}
exec $KAFKA_HOME/bin/kafka-server-start.sh $HOME/server.properties